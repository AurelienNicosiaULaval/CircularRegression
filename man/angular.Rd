% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/angular.R
\name{angular}
\alias{angular}
\title{Angular Regression Model}
\usage{
angular(
  formula,
  data,
  model = "simplified",
  initbeta = NULL,
  control = list(),
  random = NULL,
  cluster = NULL,
  alternate = TRUE
)
}
\arguments{
\item{formula}{A formula with the dependent angle on the left of the ~ operator and terms specifying
the explanatory variables on the right. These terms must be written \code{x:z}.}

\item{data}{An optional data frame, list or environment containing the variables in the model formula.}

\item{model}{A character string, either \code{"complete"} (with intercept) or \code{"simplified"} (no intercept).}

\item{initbeta}{Optional numeric vector of initial beta values.}

\item{control}{A list of control parameters. See Details.}

\item{random}{Optional one-sided formula of the form \code{~ 1 | id} to enable a VM random intercept per id.}

\item{cluster}{Optional factor giving the cluster for each row (ignored if \code{random} is supplied).}

\item{alternate}{Logical; if TRUE (default), alternates once between updating \eqn{\beta} on \eqn{y-\hat a}
and re-estimating \eqn{(\kappa_e,\kappa_a)}.}
}
\value{
An object of class "angular" containing:
\describe{
  \item{MaxCosine}{the maximum cosine value.}
  \item{parameters}{matrix of estimates, std. errors, z-values and p-values for beta.}
  \item{varcov0}{model-based variance-covariance for beta.}
  \item{varcov1}{robust (sandwich-like) variance-covariance for beta.}
  \item{long}{vector of predicted concentrations.}
  \item{mui}{vector of predicted mean angles.}
  \item{y}{the response variable.}
  \item{iter.detail}{iteration details.}
  \item{call}{the function call.}
  \item{kappa_e}{(if random intercept) estimated residual concentration.}
  \item{kappa_a}{(if random intercept) estimated random-intercept concentration.}
  \item{a_i}{(if random intercept) empirical Bayes predictors per observation (length n).}
  \item{cluster}{(if random intercept) factor of cluster membership.}
}
}
\description{
Function that fits a regression model for angular variables along with its
associated S3 methods. Optionally, a random intercept a_i ~ VM(0, kappa_a)
may be estimated for clustered data (Rivest et al., 2019).
}
\details{
The control argument is a list that can supply any of the following components:
\describe{
  \item{\code{pginit}}{Grid size for initial beta search when \code{initbeta} is missing. Default 1000.}
  \item{\code{maxiter}}{Maximum number of iterations. Default 1000.}
  \item{\code{mindiff}}{Convergence tolerance on max-cosine improvement. Default 1e-6.}
}
}
